# CI/CD ì„¤ì • ê°€ì´ë“œ

> **ì‘ì„±ì¼**: 2025-10-29
> **ëª©ì **: GitHub Actions CI/CD í™˜ê²½ êµ¬ì¶•ì„ ìœ„í•œ ì„¤ì • ê°€ì´ë“œ

---

## ğŸ“‹ ê°œìš”

ì´ í”„ë¡œì íŠ¸ëŠ” GitHub Actionsë¥¼ í†µí•´ ìë™í™”ëœ í…ŒìŠ¤íŠ¸ ë° ë¹Œë“œ ê²€ì¦ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì´ ë¬¸ì„œëŠ” CI/CD íŒŒì´í”„ë¼ì¸ì„ ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## ğŸ” í•„ìˆ˜ GitHub Secrets ì„¤ì •

GitHub ë¦¬í¬ì§€í† ë¦¬ì˜ **Settings > Secrets and variables > Actions**ì—ì„œ ë‹¤ìŒ Secretsë¥¼ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤.

### 1. Supabase ê´€ë ¨

```
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
```

### 2. Clerk ì¸ì¦ ê´€ë ¨

```
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_xxx
CLERK_SECRET_KEY=sk_test_xxx
```

### 3. Toss Payments ê´€ë ¨

```
NEXT_PUBLIC_TOSS_CLIENT_KEY=test_ck_xxx
TOSS_SECRET_KEY=test_sk_xxx
```

### 4. Gemini API ê´€ë ¨

```
GEMINI_API_KEY=your-gemini-api-key
```

### 5. E2E í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ê³„ì •

```
E2E_TEST_USER_EMAIL=test-e2e@example.com
E2E_TEST_USER_PASSWORD=your-secure-password
```

**âš ï¸ ì¤‘ìš”**: E2E í…ŒìŠ¤íŠ¸ ì‚¬ìš©ìëŠ” ì‹¤ì œ Clerkì— ë“±ë¡ëœ í…ŒìŠ¤íŠ¸ ì „ìš© ê³„ì •ì´ì–´ì•¼ í•©ë‹ˆë‹¤.

### 6. Codecov í† í° (ì„ íƒ)

ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸ë¥¼ Codecovì— ì—…ë¡œë“œí•˜ë ¤ë©´:

```
CODECOV_TOKEN=your-codecov-token
```

Codecov í† í°ì€ [codecov.io](https://codecov.io)ì—ì„œ ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì¶”ê°€í•œ í›„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸš€ ì›Œí¬í”Œë¡œìš° êµ¬ì„±

### 1. í…ŒìŠ¤íŠ¸ ì›Œí¬í”Œë¡œìš° (`.github/workflows/test.yml`)

ë‹¤ìŒ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤:

- **Unit Tests**: Vitestë¡œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë° ì»¤ë²„ë¦¬ì§€ ìˆ˜ì§‘
- **E2E Tests**: Playwrightë¡œ Chromium, Firefox ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸
- **Type Check**: TypeScript íƒ€ì… ê²€ì‚¬
- **Lint**: ESLint ì½”ë“œ ìŠ¤íƒ€ì¼ ê²€ì‚¬
- **Build**: Next.js í”„ë¡œë•ì…˜ ë¹Œë“œ

### 2. PR ì²´í¬ ì›Œí¬í”Œë¡œìš° (`.github/workflows/pr-checks.yml`)

Pull Requestì— ëŒ€í•´:

- ë³€ê²½ëœ íŒŒì¼ ê¸°ë°˜ ìë™ ë¼ë²¨ë§
- PR í¬ê¸° ë¼ë²¨ ì¶”ê°€ (XS, S, M, L, XL)
- í…ŒìŠ¤íŠ¸ ìƒíƒœ ì½”ë©˜íŠ¸ ìë™ ì¶”ê°€

---

## ğŸ“Š CI/CD íŒŒì´í”„ë¼ì¸ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Push / Pull Request to main or develop                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚               â”‚               â”‚
         â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Unit  â”‚     â”‚  E2E   â”‚     â”‚  Type  â”‚
    â”‚  Tests â”‚     â”‚  Tests â”‚     â”‚  Check â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚               â”‚               â”‚
         â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Lint  â”‚     â”‚  Build â”‚     â”‚ Upload â”‚
    â”‚        â”‚     â”‚        â”‚     â”‚Coverageâ”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  All Checks Pass â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› ï¸ ë¡œì»¬ì—ì„œ CI í™˜ê²½ ì¬í˜„

CIì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²ƒê³¼ ë™ì¼í•œ í…ŒìŠ¤íŠ¸ë¥¼ ë¡œì»¬ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```bash
# 1. íƒ€ì… ì²´í¬
npx tsc --noEmit

# 2. ë¦°íŠ¸
npm run lint

# 3. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (ì»¤ë²„ë¦¬ì§€ í¬í•¨)
npm run test:unit:coverage

# 4. E2E í…ŒìŠ¤íŠ¸
npm run test:e2e

# 5. ë¹Œë“œ
npm run build
```

---

## ğŸ” íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### E2E í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨

**ë¬¸ì œ**: E2E í…ŒìŠ¤íŠ¸ê°€ CIì—ì„œ ì‹¤íŒ¨í•˜ì§€ë§Œ ë¡œì»¬ì—ì„œëŠ” ì„±ê³µ

**í•´ê²°**:
1. GitHub Secretsì— `E2E_TEST_USER_EMAIL`ê³¼ `E2E_TEST_USER_PASSWORD`ê°€ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
2. í…ŒìŠ¤íŠ¸ ê³„ì •ì´ Clerkì— ì‹¤ì œë¡œ ë“±ë¡ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
3. Actions íƒ­ì—ì„œ ìƒì„¸ ë¡œê·¸ í™•ì¸

### ë¹Œë“œ ì‹¤íŒ¨

**ë¬¸ì œ**: í™˜ê²½ ë³€ìˆ˜ ê´€ë ¨ ë¹Œë“œ ì—ëŸ¬

**í•´ê²°**:
1. ëª¨ë“  `NEXT_PUBLIC_*` í™˜ê²½ ë³€ìˆ˜ê°€ GitHub Secretsì— ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
2. Secrets ì´ë¦„ì´ ì •í™•í•œì§€ í™•ì¸ (ëŒ€ì†Œë¬¸ì êµ¬ë¶„)

### ì»¤ë²„ë¦¬ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨

**ë¬¸ì œ**: Codecov ì—…ë¡œë“œ ì‹¤íŒ¨

**í•´ê²°**:
1. `CODECOV_TOKEN`ì´ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
2. Codecovì—ì„œ ë¦¬í¬ì§€í† ë¦¬ê°€ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
3. í† í°ì´ ì„ íƒ ì‚¬í•­ì´ë¯€ë¡œ ì—†ì–´ë„ CIëŠ” í†µê³¼ë¨

---

## ğŸ“ˆ ë°°ì§€ ì¶”ê°€

README.mdì— ë‹¤ìŒ ë°°ì§€ë¥¼ ì¶”ê°€í•˜ì—¬ CI ìƒíƒœë¥¼ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```markdown
![Tests](https://github.com/YOUR_USERNAME/YOUR_REPO/workflows/Tests/badge.svg)
[![codecov](https://codecov.io/gh/YOUR_USERNAME/YOUR_REPO/branch/main/graph/badge.svg)](https://codecov.io/gh/YOUR_USERNAME/YOUR_REPO)
```

`YOUR_USERNAME`ê³¼ `YOUR_REPO`ë¥¼ ì‹¤ì œ ê°’ìœ¼ë¡œ êµì²´í•˜ì„¸ìš”.

---

## ğŸ¯ ê¶Œì¥ ì‚¬í•­

### PR ë³‘í•© ì¡°ê±´

ë¦¬í¬ì§€í† ë¦¬ ì„¤ì •ì—ì„œ ë‹¤ìŒ ë³´í˜¸ ê·œì¹™ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤:

1. **Settings > Branches > Branch protection rules**
2. **main** ë¸Œëœì¹˜ì— ëŒ€í•´:
   - âœ… Require a pull request before merging
   - âœ… Require status checks to pass before merging
     - Unit Tests
     - E2E Tests (chromium)
     - E2E Tests (firefox)
     - Type Check
     - Lint
     - Build
   - âœ… Require branches to be up to date before merging

### ì„±ëŠ¥ ìµœì í™”

- **ìºì‹±**: GitHub ActionsëŠ” `node_modules` ìºì‹±ì„ ìë™ìœ¼ë¡œ ìˆ˜í–‰
- **ë³‘ë ¬ ì‹¤í–‰**: E2E í…ŒìŠ¤íŠ¸ëŠ” Chromiumê³¼ Firefoxë¥¼ ë³‘ë ¬ë¡œ ì‹¤í–‰
- **ì‹¤íŒ¨ ë¹ ë¥¸ ê°ì§€**: `fail-fast: false`ë¡œ ì„¤ì •í•˜ì—¬ í•œ ë¸Œë¼ìš°ì € ì‹¤íŒ¨ ì‹œì—ë„ ë‹¤ë¥¸ ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸ ê³„ì†

---

## ğŸ“š ì¶”ê°€ ìë£Œ

- [GitHub Actions ë¬¸ì„œ](https://docs.github.com/en/actions)
- [Playwright CI ê°€ì´ë“œ](https://playwright.dev/docs/ci)
- [Vitest CI ê°€ì´ë“œ](https://vitest.dev/guide/ci.html)
- [Codecov ê°€ì´ë“œ](https://docs.codecov.com/docs)

---

**ì´ ë¬¸ì„œëŠ” í”„ë¡œì íŠ¸ì˜ CI/CD í™˜ê²½ ë³€í™”ì— ë”°ë¼ ì§€ì†ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.**
